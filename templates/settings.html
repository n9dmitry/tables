{% extends "layout.html" %}

{% block title %}Настройки{% endblock %}
{% block settings %}
<div class="container mt-5">
    <h1 class="text-center">Настройки</h1>

    <h2 class="mt-4">Материалы</h2>
    <table class="table table-striped table-bordered mt-2">
        <thead class="thead-dark">
            <tr>
                <th>Название</th>
                <th>Цена за м²</th>
                <th>Ширина (м)</th>
                <th>Длина (м)</th>
                <th>Стоимость рулона</th>
                <th>Примечание</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for material in materials %}
            <tr>
                <td>{{ material.name }}</td>
                <td>{{ material.price_per_sqm }}</td>
                <td>{{ material.width }}</td>
                <td>{{ material.length }}</td>
                <td>{{ material.roll_cost }}</td>
                <td>{{ material.note }}</td>
                <td>
                    <button class="btn btn-success" data-toggle="modal" data-target="#editMaterialModal{{ loop.index }}">
                      <i class="fas fa-edit"></i>
                    </button>
                </td>

                <!-- Модальное окно редактирования материала -->
                <div class="modal fade" id="editMaterialModal{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="editMaterialModalLabel{{ loop.index }}" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <form method="post" action="/settings/update_material/{{ material.name }}">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="editMaterialModalLabel{{ loop.index }}">Редактирование материала: {{ material.name }}</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label for="material_name">Название</label>
                                        <input type="text" class="form-control" id="material_name" name="name" value="{{ material.name }}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="material_price_per_sqm">Цена за м²</label>
                                        <input type="number" step="0.01" class="form-control" id="material_price_per_sqm" name="price_per_sqm" value="{{ material.price_per_sqm }}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="material_width">Ширина (м)</label>
                                        <input type="number" step="0.01" class="form-control" id="material_width" name="width" value="{{ material.width }}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="material_length">Длина (м)</label>
                                        <input type="number" step="0.01" class="form-control" id="material_length" name="length" value="{{ material.length }}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="material_roll_cost">Стоимость рулона</label>
                                        <input type="number" step="0.01" class="form-control" id="material_roll_cost" name="roll_cost" value="{{ material.roll_cost }}" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="material_note">Примечание</label>
                                        <input type="text" class="form-control" id="material_note" name="note" value="{{ material.note }}">
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                                    <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2 class="mt-4">Аксессуары</h2>
<table class="table table-striped table-bordered mt-2">
    <thead class="thead-dark">
        <tr>
            <th>Название</th>
            <th>Цена за единицу</th>
            <th>Примечание</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for accessory in accessories %}
        <tr>
            <td>{{ accessory.name }}</td>
            <td>{{ accessory.price_per_unit }}</td>
            <td>{{ accessory.note }}</td>
            <td>
                <button class="btn btn-success" data-toggle="modal" data-target="#editAccessoryModal{{ loop.index }}">
                    <i class="fas fa-edit"></i>
                </button>
            </td>

            <!-- Модальное окно редактирования аксесуаров -->
            <div class="modal fade" id="editAccessoryModal{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="editAccessoryModalLabel{{ loop.index }}" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <form method="post" action="/settings/update_accessory/{{ accessory.name }}">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editAccessoryModalLabel{{ loop.index }}">Редактирование аксессуара: {{ accessory.name }}</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label for="accessory_name">Название</label>
                                    <input type="text" class="form-control" id="accessory_name" name="name" value="{{ accessory.name }}" required>
                                </div>
                                <div class="form-group">
                                    <label for="accessory_price_per_unit">Цена за единицу</label>
                                    <input type="number" step="0.01" class="form-control" id="accessory_price_per_unit" name="price_per_unit" value="{{ accessory.price_per_unit }}" required>
                                </div>
                                <div class="form-group">
                                    <label for="accessory_note">Примечание</label>
                                    <input type="text" class="form-control" id="accessory_note" name="note" value="{{ accessory.note }}">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                                <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </tr>
        {% endfor %}
    </tbody>
</table>


    <h2 class="mt-4">Краска</h2>
<table class="table table-striped table-bordered mt-2">
    <thead class="thead-dark">
        <tr>
            <th>Стоимость литра</th>
            <th>Расход на м²</th>
            <th>Стоимость печати на м²</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{ paint.liter_cost }}</td>
            <td>{{ paint.consumption_per_sqm }}</td>
            <td>{{ paint.printing_cost_per_sqm }}</td>
            <td>
                <button class="btn btn-success" data-toggle="modal" data-target="#editPaintModal">
                    <i class="fas fa-edit"></i>
                </button>
            </td>

            <!-- Модальное окно редактирования краски -->
            <div class="modal fade" id="editPaintModal" tabindex="-1" role="dialog" aria-labelledby="editPaintModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <form method="post" action="/settings/update_paint">
                            <div class="modal-header">
                                <h5 class="modal-title" id="editPaintModalLabel">Редактирование краски</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label for="paint_liter_cost">Стоимость литра</label>
                                    <input type="number" step="0.01" class="form-control" id="paint_liter_cost" name="liter_cost" value="{{ paint.liter_cost }}" required>
                                </div>
                                <div class="form-group">
                                    <label for="paint_consumption_per_sqm">Расход на м²</label>
                                    <input type="number" step="0.01" class="form-control" id="paint_consumption_per_sqm" name="consumption_per_sqm" value="{{ paint.consumption_per_sqm }}" required>
                                </div>
                                <div class="form-group">
                                    <label for="paint_printing_cost_per_sqm">Стоимость печати на м²</label>
                                    <input type="number" step="0.01" class="form-control" id="paint_printing_cost_per_sqm" name="printing_cost_per_sqm" value="{{ paint.printing_cost_per_sqm }}" required>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                                <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </tr>
    </tbody>
</table>


    <h2 class="mt-4">Тарифы</h2>
    <table class="table table-striped table-bordered mt-2">
        <thead class="thead-dark">
            <tr>
                <th>Тип тарифа</th>
                <th>Ставка</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Тариф принтера за м²</td>
                <td>{{ rates.printer_rate_per_sqm }}</td>
            </tr>
            <tr>
                <td>Ставка люверса</td>
                <td>{{ rates.eyelet_rate }}</td>
            </tr>
            <tr>
                <td>Ставка резака за м²</td>
                <td>{{ rates.cutter_rate_per_sqm }}</td>

            </tr>
            <tr>
                <td>Ставка сварщика</td>
                <td>{{ rates.welder_rate }}</td>
            </tr>


                    <button class="btn btn-success" data-toggle="modal" data-target="#editRatesModal">
                      <i class="fas fa-edit"></i>
                    </button>




        </tbody>
    </table>

    <!-- Модальное окно редактирования тарифов -->
    <div class="modal fade" id="editRatesModal" tabindex="-1" role="dialog" aria-labelledby="editRatesModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form method="post" action="/settings/update_rates">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editRatesModalLabel">Редактирование тарифов</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="printer_rate_per_sqm">Тариф принтера за м²</label>
                            <input type="number" step="0.01" class="form-control" id="printer_rate_per_sqm" name="printer_rate_per_sqm" value="{{ rates.printer_rate_per_sqm }}" required>
                        </div>
                        <div class="form-group">
                            <label for="eyelet_rate">Ставка люверса</label>
                            <input type="number" step="0.01" class="form-control" id="eyelet_rate" name="eyelet_rate" value="{{ rates.eyelet_rate }}" required>
                        </div>
                        <div class="form-group">
                            <label for="cutter_rate_per_sqm">Ставка резака за м²</label>
                            <input type="number" step="0.01" class="form-control" id="cutter_rate_per_sqm" name="cutter_rate_per_sqm" value="{{ rates.cutter_rate_per_sqm }}" required>
                        </div>
                        <div class="form-group">
                            <label for="welder_rate">Ставка сварщика</label>
                            <input type="number" step="0.01" class="form-control" id="welder_rate" name="welder_rate" value="{{ rates.welder_rate }}" required>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Закрыть</button>
                        <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <h2 class="mt-4">Исполнители</h2>

    <ul class="list-group mt-2">
        {% for performer in performers %}
        <li class="list-group-item">{{ performer }}</li>
        {% endfor %}
    </ul>

    <h2 class="mt-4">Дополнительные опции</h2>
    <p class="mt-2">Доступна дополнительная опция: <strong>{{ options.additional_option.available }}</strong></p>
</div>

{% endblock %}
